-- 扶贫供应商销售情况
create table csx_analyse_tmp.csx_analyse_tmp_csx_dim_supplier as 
select *
from csx_dim.csx_dim_basic_supplier
where sdt = 'current'
    and ( street_name like 	'%喀喇沁旗%'
or street_name like 	'%敖汉旗%'
or street_name like 	'%林西县%'
or street_name like 	'%宁城县%'
or street_name like 	'%翁牛特旗%'
or street_name like 	'%巴林左旗%'
or street_name like 	'%阿鲁科尔沁旗%'
or street_name like 	'%巴林右旗%'
or street_name like 	'%化德县%'
or street_name like 	'%卓资县%'
or street_name like 	'%察哈尔右翼后旗%'
or street_name like 	'%察哈尔右翼中旗%'
or street_name like 	'%察哈尔右翼前旗%'
or street_name like 	'%商都县%'
or street_name like 	'%四子王旗%'
or street_name like 	'%兴和县%'
or street_name like 	'%崇礼区%'
or street_name like 	'%张北县%'
or street_name like 	'%康保县%'
or street_name like 	'%赤城县%'
or street_name like 	'%涿鹿县%'
or street_name like 	'%沽源县%'
or street_name like 	'%尚义县%'
or street_name like 	'%丰宁满族自治县%'
or street_name like 	'%滦平县%'
or street_name like 	'%阜平县%'
or street_name like 	'%顺平县%'
or street_name like 	'%涞水县%'
or street_name like 	'%唐县%'
or street_name like 	'%易县%'
or street_name like 	'%涞源县%'
or street_name like 	'%当雄县%'
or street_name like 	'%尼木县%'
or street_name like 	'%城关区%'
or street_name like 	'%堆龙德庆区%'
or street_name like 	'%墨玉县%'
or street_name like 	'%和田市%'
or street_name like 	'%和田县%'
or street_name like 	'%洛浦县%'
or street_name like 	'%囊谦县%'
or street_name like 	'%治多县%'
or street_name like 	'%曲麻莱县%'
or street_name like 	'%称多县%'
or street_name like 	'%杂多县%'
or street_name like 	'%玉树市%'
or street_name like 	'%合作市%'
or street_name like 	'%夏河县%'
or street_name like 	'%舟曲县%'
or street_name like 	'%卓尼县%'
or street_name like 	'%临潭县%'
or street_name like 	'%迭部县%'
or street_name like 	'%碌曲县%'
or street_name like 	'%玛曲县%'
or street_name like 	'%天祝藏族自治县%'
or street_name like 	'%承德县%'
or street_name like 	'%平泉县%'
or street_name like 	'%隆化县%'
or street_name like 	'%围场满族蒙古族自治县%'
or street_name like 	'%卡若区%'
or street_name like 	'%丁青县%'
or street_name like 	'%江达县%'
or street_name like 	'%贡觉县%'
or street_name like 	'%策勒县%'
or street_name like 	'%于田县%'
or street_name like 	'%民丰县%'
or street_name like 	'%同仁县%'
or street_name like 	'%尖扎县%'
or street_name like 	'%泽库县%'
or street_name like 	'%河南蒙古族自治县%'
or street_name like 	'%盘县%'
or street_name like 	'%六枝特区%'
or street_name like 	'%水城县%'
or street_name like 	'%安多县%'
or street_name like 	'%索县%'
or street_name like 	'%巴青县%'
or street_name like 	'%托里县%'
or street_name like 	'%元阳县%'
or street_name like 	'%红河县%'
or street_name like 	'%广南县%'
or street_name like 	'%马关县%'
or street_name like 	'%墨江县%'
or street_name like 	'%澜沧县%'
or street_name like 	'%弥渡县%'
or street_name like 	'%南涧县%'
or street_name like 	'%武定县%'
or street_name like 	'%大姚县%'
or street_name like 	'%勐腊县%'
or street_name like 	'%梁河县%'
or street_name like 	'%香格里拉市%'
or street_name like 	'%维西县%'
or street_name like 	'%赤水市%'
or street_name like 	'%桐梓县%'
or street_name like 	'%习水县%'
or street_name like 	'%道真仡佬族自治县%'
or street_name like 	'%正安县%'
or street_name like 	'%湄潭县%'
or street_name like 	'%凤冈县%'
or street_name like 	'%务川仡佬族苗族自治县%'
or street_name like 	'%江孜县%'
or street_name like 	'%定日县%'
or street_name like 	'%萨迦县%'
or street_name like 	'%拉孜县%'
or street_name like 	'%亚东县%'
or street_name like 	'%泽普县%'
or street_name like 	'%莎车县%'
or street_name like 	'%叶城县%'
or street_name like 	'%巴楚县%'
or street_name like 	'%玛沁县%'
or street_name like 	'%班玛县%'
or street_name like 	'%甘德县%'
or street_name like 	'%达日县%'
or street_name like 	'%久治县%'
or street_name like 	'%玛多县%'
or street_name like 	'%延川县%'
or street_name like 	'%延长县%'
or street_name like 	'%富平县%'
or street_name like 	'%白水县%'
or street_name like 	'%洛南县%'
or street_name like 	'%镇安县%'
or street_name like 	'%绥德县%'
or street_name like 	'%子洲县%'
or street_name like 	'%麟游县%'
or street_name like 	'%陇县%'
or street_name like 	'%汉滨区%'
or street_name like 	'%紫阳县%'
or street_name like 	'%西乡县%'
or street_name like 	'%勉县%'
or street_name like 	'%旬邑县%'
or street_name like 	'%永寿县%'
or street_name like 	'%耀州区%'
or street_name like 	'%宜君县%'
or street_name like 	'%周至县%'
or street_name like 	'%江口县%'
or street_name like 	'%石阡县%'
or street_name like 	'%思南县%'
or street_name like 	'%印江土家族苗族自治县%'
or street_name like 	'%德江县%'
or street_name like 	'%沿河土家族自治县%'
or street_name like 	'%松桃苗族自治县%'
or street_name like 	'%碧江区%'
or street_name like 	'%万山区%'
or street_name like 	'%玉屏侗族自治县%'
or street_name like 	'%湟中县%'
or street_name like 	'%大通县%'
or street_name like 	'%湟源县%'
or street_name like 	'%乐都区%'
or street_name like 	'%平安区%'
or street_name like 	'%化隆县%'
or street_name like 	'%民和县%'
or street_name like 	'%互助县%'
or street_name like 	'%循化县%'
or street_name like 	'%共和县%'
or street_name like 	'%同德县%'
or street_name like 	'%贵德县%'
or street_name like 	'%兴海县%'
or street_name like 	'%贵南县%'
or street_name like 	'%林周县%'
or street_name like 	'%曲水县%'
or street_name like 	'%达孜县%'
or street_name like 	'%墨竹工卡县%'
or street_name like 	'%察布查尔锡伯自治县%'
or street_name like 	'%尼勒克县%'
or street_name like 	'%阿图什市%'
or street_name like 	'%阿合奇县%'
or street_name like 	'%乌恰县%'
or street_name like 	'%木里藏族自治县%'
or street_name like 	'%壤塘县%'
or street_name like 	'%阿坝县%'
or street_name like 	'%黑水县%'
or street_name like 	'%九寨沟县%'
or street_name like 	'%汶川县%'
or street_name like 	'%理县%'
or street_name like 	'%茂县%'
or street_name like 	'%松潘县%'
or street_name like 	'%小金县%'
or street_name like 	'%金川县%'
or street_name like 	'%马尔康市%'
or street_name like 	'%若尔盖县%'
or street_name like 	'%红原县%'
or street_name like 	'%屏山县%'
or street_name like 	'%马边彝族自治县%'
or street_name like 	'%兴仁县%'
or street_name like 	'%普安县%'
or street_name like 	'%晴隆县%'
or street_name like 	'%贞丰县%'
or street_name like 	'%望谟县%'
or street_name like 	'%册亨县%'
or street_name like 	'%安龙县%'
or street_name like 	'%镇远县%'
or street_name like 	'%黄平县%'
or street_name like 	'%施秉县%'
or street_name like 	'%三穗县%'
or street_name like 	'%岑巩县%'
or street_name like 	'%天柱县%'
or street_name like 	'%台江县%'
or street_name like 	'%锦屏县%'
or street_name like 	'%剑河县%'
or street_name like 	'%黎平县%'
or street_name like 	'%榕江县%'
or street_name like 	'%从江县%'
or street_name like 	'%雷山县%'
or street_name like 	'%麻江县%'
or street_name like 	'%丹寨县%'
or street_name like 	'%咸丰县%'
or street_name like 	'%来凤县%'
or street_name like 	'%宣恩县%'
or street_name like 	'%利川市%'
or street_name like 	'%恩施市%'
or street_name like 	'%鹤峰县%'
or street_name like 	'%巴东县%'
or street_name like 	'%建始县%'
or street_name like 	'%安图县%'
or street_name like 	'%汪清县%'
or street_name like 	'%龙井市%'
or street_name like 	'%和龙市%'
or street_name like 	'%那曲县%'
or street_name like 	'%嘉黎县%'
or street_name like 	'%比如县%'
or street_name like 	'%乌什县%'
or street_name like 	'%柯枰县%'
or street_name like 	'%格尔木市%'
or street_name like 	'%德令哈市%'
or street_name like 	'%乌兰县%'
or street_name like 	'%都兰县%'
or street_name like 	'%天峻县%'
or street_name like 	'%冷湖行委%'
or street_name like 	'%大柴旦行委%'
or street_name like 	'%茫崖行委%'
or street_name like 	'%盐池县%'
or street_name like 	'%同心县%'
or street_name like 	'%原州区%'
or street_name like 	'%隆德县%'
or street_name like 	'%西吉县%'
or street_name like 	'%泾源县%'
or street_name like 	'%彭阳县%'
or street_name like 	'%海原县%'
or street_name like 	'%临夏县%'
or street_name like 	'%康乐县%'
or street_name like 	'%永靖县%'
or street_name like 	'%广河县%'
or street_name like 	'%和政县%'
or street_name like 	'%东乡族自治县%'
or street_name like 	'%积石山自治县%'
or street_name like 	'%岷县%'
or street_name like 	'%通渭县%'
or street_name like 	'%漳县%'
or street_name like 	'%渭源县%'
or street_name like 	'%临洮县%'
or street_name like 	'%安定区%'
or street_name like 	'%陇西县%'
or street_name like 	'%八宿县%'
or street_name like 	'%左贡县%'
or street_name like 	'%洛隆县%'
or street_name like 	'%边坝县%'
or street_name like 	'%城口县%'
or street_name like 	'%云阳县%'
or street_name like 	'%奉节县%'
or street_name like 	'%巫山县%'
or street_name like 	'%巫溪县%'
or street_name like 	'%丰都县%'
or street_name like 	'%武隆县%'
or street_name like 	'%黔江区%'
or street_name like 	'%石柱土家族自治县%'
or street_name like 	'%秀山土家族苗族自治县%'
or street_name like 	'%酉阳土家族苗族自治县%'
or street_name like 	'%彭水苗族土家族自治县%'
or street_name like 	'%万州区%'
or street_name like 	'%开州区%'
or street_name like 	'%普定县%'
or street_name like 	'%镇宁布依族苗族自治县%'
or street_name like 	'%关岭布依族苗族自治县%'
or street_name like 	'%紫云苗族布依族自治县%'
or street_name like 	'%西秀区%'
or street_name like 	'%平坝区%'
or street_name like 	'%永顺县%'
or street_name like 	'%龙山县%'
or street_name like 	'%古丈县%'
or street_name like 	'%保靖县%'
or street_name like 	'%泸溪县%'
or street_name like 	'%花垣县%'
or street_name like 	'%凤凰县%'
or street_name like 	'%宕昌县%'
or street_name like 	'%西和县%'
or street_name like 	'%康县%'
or street_name like 	'%礼县%'
or street_name like 	'%成县%'
or street_name like 	'%武都区%'
or street_name like 	'%文县%'
or street_name like 	'%徽县%'
or street_name like 	'%两当县%'
or street_name like 	'%白朗县%'
or street_name like 	'%桑珠孜区%'
or street_name like 	'%昂仁县%'
or street_name like 	'%聂拉木县%'
or street_name like 	'%南木林县%'
or street_name like 	'%疏勒县%'
or street_name like 	'%英吉沙县%'
or street_name like 	'%岳普湖县%'
or street_name like 	'%麦盖提县%'
or street_name like 	'%门源回族自治县%'
or street_name like 	'%祁连县%'
or street_name like 	'%海晏县%'
or street_name like 	'%刚察县%'
or street_name like 	'%田东县%'
or street_name like 	'%田阳县%'
or street_name like 	'%德保县%'
or street_name like 	'%靖西市%'
or street_name like 	'%那坡县%'
or street_name like 	'%凌云县%'
or street_name like 	'%乐业县%'
or street_name like 	'%田林县%'
or street_name like 	'%西林县%'
or street_name like 	'%隆林各族自治县%'
or street_name like 	'%凤山县%'
or street_name like 	'%东兰县%'
or street_name like 	'%罗城仫佬族自治县%'
or street_name like 	'%环江毛南族自治县%'
or street_name like 	'%巴马瑶族自治县%'
or street_name like 	'%都安瑶族自治县%'
or street_name like 	'%大化瑶族自治县%'
or street_name like 	'%甘孜县%'
or street_name like 	'%德格县%'
or street_name like 	'%石渠县%'
or street_name like 	'%色达县%'
or street_name like 	'%新龙县%'
or street_name like 	'%炉霍县%'
or street_name like 	'%稻城县%'
or street_name like 	'%理塘县%'
or street_name like 	'%白玉县%'
or street_name like 	'%巴塘县%'
or street_name like 	'%九龙县%'
or street_name like 	'%雅江县%'
or street_name like 	'%康定市%'
or street_name like 	'%泸定县%'
or street_name like 	'%丹巴县%'
or street_name like 	'%道孚县%'
or street_name like 	'%乡城县%'
or street_name like 	'%得荣县%'
or street_name like 	'%普格县%'
or street_name like 	'%昭觉县%'
or street_name like 	'%布拖县%'
or street_name like 	'%甘洛县%'
or street_name like 	'%越西县%'
or street_name like 	'%喜德县%'
or street_name like 	'%美姑县%'
or street_name like 	'%金阳县%'
or street_name like 	'%雷波县%'
or street_name like 	'%盐源县%'
or street_name like 	'%木里藏族自治县%'
or street_name like 	'%泸水县%'
or street_name like 	'%福贡县%'
or street_name like 	'%贡山独龙族怒族自治县%'
or street_name like 	'%兰坪白族普米族自治县%'
or street_name like 	'%镇雄县%'
or street_name like 	'%彝良县%'
or street_name like 	'%昭阳区%'
or street_name like 	'%威信县%'
or street_name like 	'%鲁甸县%'
or street_name like 	'%巧家县%'
or street_name like 	'%大关县%'
or street_name like 	'%盐津县%'
or street_name like 	'%绥江县%'
or street_name like 	'%永善县%'
or street_name like 	'%罗甸县%'
or street_name like 	'%长顺县%'
or street_name like 	'%瓮安县%'
or street_name like 	'%荔波县%'
or street_name like 	'%平塘县%'
or street_name like 	'%独山县%'
or street_name like 	'%三都水族自治县%'
or street_name like 	'%贵定县%'
or street_name like 	'%龙里县%'
or street_name like 	'%惠水县%'
or street_name like 	'%七星关区%'
or street_name like 	'%大方县%'
or street_name like 	'%纳雍县%'
or street_name like 	'%织金县%'
or street_name like 	'%黔西县%'
or street_name like 	'%威宁彝族回族苗族自治县%'
or street_name like 	'%赫章县%'
or street_name like 	'%巴宜区%'
or street_name like 	'%墨脱县%'
or street_name like 	'%波密县%'
or street_name like 	'%察隅县%'
or street_name like 	'%工布江达县%'
or street_name like 	'%米林县%'
or street_name like 	'%朗县%'
or street_name like 	'%疏附县%'
or street_name like 	'%伽师县%'
or street_name like 	'%喀什市%'
or street_name like 	'%塔什库尔干塔吉克自治县%'
    )
    
   ;

   -- 销售关联 
select substr(sdt,1,4) year, a.performance_region_code,performance_region_name,performance_province_code,performance_province_name,

b.supplier_code,b.supplier_name,dc_code,street_name,city_name,

sum(sale_amt) sale_amt
from csx_dws.csx_dws_sale_detail_di  a 
join 
(select goods_code,goods_name,a.supplier_code,b.supplier_name,dc_code,street_name,city_name from csx_dim.csx_dim_basic_dc_goods a 
 join csx_analyse_tmp.csx_analyse_tmp_csx_dim_supplier  b on a.supplier_code=b.supplier_code
where a.sdt='current') b on a.goods_code=b.goods_code and inventory_dc_code=b.dc_code 
where sdt>='20210101'
group by  substr(sdt,1,4)  , a.performance_region_code,performance_region_name,performance_province_code,performance_province_name,

b.supplier_code,b.supplier_name,dc_code,street_name,city_name

;


-- 商品级别
select substr(sdt,1,4) year, a.performance_region_code,performance_region_name,performance_province_code,performance_province_name,
a.goods_code,a.goods_name,classify_large_code,classify_large_name,classify_middle_code,classify_middle_name,
b.supplier_code,b.supplier_name,dc_code,street_name,city_name,

sum(sale_amt) sale_amt
from csx_dws.csx_dws_sale_detail_di  a 
join 
(select goods_code,goods_name,a.supplier_code,b.supplier_name,dc_code,street_name,city_name from csx_dim.csx_dim_basic_dc_goods a 
 join csx_analyse_tmp.csx_analyse_tmp_csx_dim_supplier  b on a.supplier_code=b.supplier_code
where a.sdt='current') b on a.goods_code=b.goods_code and inventory_dc_code=b.dc_code 
where sdt>='20210101'
group by  substr(sdt,1,4)  , a.performance_region_code,performance_region_name,performance_province_code,performance_province_name,

b.supplier_code,b.supplier_name,dc_code,street_name,city_name
,a.goods_code,a.goods_name,classify_large_code,classify_large_name,classify_middle_code,classify_middle_name
;
