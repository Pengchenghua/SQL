# 帆软报表中使用鼠标移动变色效果的说明

## 使用方法

### 方法一：直接在报表中嵌入JS（推荐）
1. 打开您的 `.cptx` 报表文件
2. 选择菜单：`模板` → `模板 Web 属性` → `分页预览设置`
3. 在 `事件设置` 选项卡中，选择 `为该模板单独设置`
4. 在 `加载结束` 事件中添加以下代码：

```javascript
// 引入鼠标移动变色效果
$.getScript("${servletURL}javascript/鼠标移动变色.js", function() {
    // 初始化效果
    TableHoverEffect.init();
    
    // 可选：自定义配置
    TableHoverEffect.setConfig({
        HOVER_BACKGROUND: "#E6E6FA",  // 淡紫色
        HEADER_ROWS: 2                // 根据实际表头行数调整
    });
});
```

### 方法二：全局JS文件引用
1. 将 `鼠标移动变色.js` 文件上传到帆软服务器的 `webapps/webroot/javascript/` 目录
2. 在报表的 `加载结束` 事件中添加：
```javascript
// 直接调用效果
setTimeout(function() {
    if (typeof TableHoverEffect !== 'undefined') {
        TableHoverEffect.init();
    }
}, 500);
```

### 方法三：通过HTML导入
在报表的 `HTML` 内容框中添加：
```html
<script src="${servletURL}javascript/鼠标移动变色.js"></script>
<script>
$(document).ready(function() {
    setTimeout(function() {
        TableHoverEffect.init();
    }, 300);
});
</script>
```

## 重要注意事项

### 1. 路径问题
- 确保JS文件路径正确
- 使用 `${servletURL}` 变量确保路径正确性

### 2. 表格选择器
- 默认选择器：`.x-table tr:gt(1)` （跳过前2行作为表头）
- 如果表格结构不同，需要调整 `HEADER_ROWS` 配置

### 3. 冻结列支持
- 默认启用冻结列支持 (`SUPPORT_FROZEN: true`)
- 如果报表没有冻结列，可以设置为 `false` 提高性能

### 4. 性能优化
对于大数据量表格：
```javascript
TableHoverEffect.setConfig({
    HOVER_BACKGROUND: "#E0FFFF",
    SUPPORT_FROZEN: false,  // 如果没有冻结列
    HEADER_ROWS: 1          // 根据实际表头行数
});
```

## 常见问题排查

### Q: 效果不生效
1. 检查浏览器控制台是否有错误
2. 确认JS文件路径正确
3. 检查表格的CSS类名是否正确

### Q: 颜色闪烁或异常
1. 检查是否有其他CSS覆盖
2. 确认 `HEADER_ROWS` 设置正确

### Q: 冻结列效果异常
1. 确认报表是否有冻结列设置
2. 检查冻结列容器的ID是否为 `frozen-west`

## 配置参数说明

| 参数 | 类型 | 默认值 | 说明 |
|------|------|--------|------|
| HOVER_BACKGROUND | string | "#E0FFFF" | 悬停时的背景颜色 |
| SUPPORT_FROZEN | boolean | true | 是否支持冻结列 |
| HEADER_ROWS | number | 2 | 表头行数（从0开始） |

## 技术支持
如有问题，请检查：
1. 浏览器开发者工具的控制台输出
2. 网络面板确认JS文件加载成功
3. 报表的HTML结构是否匹配选择器